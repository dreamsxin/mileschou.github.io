---
title: 前後端分離等級表
layout: post
tags:
- gossip
- frontend
- backend
---

記得一開始寫網頁的時候（大概是 2009 年），就有在考慮前後端分離了。原因是當時有一位合作的夥伴主攻前端，而我以前有玩過 Linux 與架站，所以就繼續往後端研究。

後來對後端越來越熟，就想待舒適圈不想學前端，於是就更會研究如何順利的做前後端分離。至今，前後端分離聽過的方法非常多，今天就來將這些方法做個分類。

## Level 1

依檔案分類做為前後端分離的依據，如 `.php` 是後端負責的程式、`.js` 與 `.css` 則是前端負責的程式。前後端整合方法是由前端先切好版，產生 HTML / CSS / Javascript 等檔案後，再交由後端轉換成後端程式。

### 注意事項

這通常是在一開始沒有設計架構的前提下，硬是切出一個前端職位的狀況。最常遇到都會是整合上的問題：

* 因為後端不熟前端，因此造成轉換出來的程式並非前端所預期的。
* 因為前端不熟後端，因此造成撰寫與後端互動的 Javascript 程式，並非後端所預期的。

當遇到這一類問題，就會兩個人坐在同一台電腦上 pair programming。當然 pair programming 很好也沒什麼錯，問題在於這違反一開始切分職務的構想。

## Level 2

制定串接文件，如 API 文件，讓前端能參考文件寫出可用的程式，這個方法理論上能順利完成前後端整合。

### 注意事項

計劃永遠趕不上變化，文件變化永遠趕不上程式進化。因此遇到最大的問題即為：沒有人想更新文件。

## Level 3

前端直接使用後端所提供的 HTML 樣板引擎（template engine）作為頁面輸出 HTML 的主要方法，樣版所需要的參數也由後端提供，後端不參與修改 HTML。而輸出 HTML 後，使用 AJAX 跟後端做互動。

### 注意事項

* 前端需學習樣版引擎，即便相同的後端語言也會有多種樣版引擎，如 PHP 就有 [Smarty][]、[Blade][]、[Twig][]、[Volt][] 等，非常多選擇。
* 前端雖然不需完全了解後端語言，但仍需了解後端傳給前端參數的用法，以及部分後端語言的特性，如迴圈與判斷等。

[Smarty]: https://www.smarty.net/
[Blade]: https://laravel.com/docs/master/blade
[Twig]: https://twig.symfony.com/
[Volt]: https://docs.phalcon.io/3.4/en/volt

## Level 4

除了最開始 HTML 由後端輸出以外，其他 DOM 元素或路由處理，全部交由前端負責。

從這裡開始，已經算是 SPA 了，前端 HTML 調整完全不會影響後端的程式。

### 注意事項

* 因後端只固定輸出最開始的 HTML，因此 SEO 就會有問題

## Level 5

這是最終階段，前端的程式已經有如 App 一般，可以獨立放在任何狀置的瀏覽器執行。

達到此階段的必要條件是：輸出最開始 HTML 的 Web 服務，也交由前端管理，做法有很多種如下：

* 直接讓前端管理 Apache / Nginx 伺服器裡的 HTML 內容
* 使用 AWS S3 + AWS CloudFront 作為 Web 服務
* 使用 GitHub Pages 作為 Web 服務

### 注意事項

最初的網頁輸出已不在後端，因此身分驗證將會是一大難題，可參考 [RFC 8252 - OAuth 2.0 for Native Apps](https://tools.ietf.org/html/rfc8252) 了解相關的細節。

解法除了參考其他規範外，還一個也很直接的解法是：讓前端多做後端驗證的事即可，比方說寫 Node 伺服器來做身分驗證與 API proxy。
